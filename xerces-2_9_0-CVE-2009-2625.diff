--- src/org/apache/xerces/impl/XMLScanner.java	2006-11-22 23:36:57.000000000 +0000
+++ src/org/apache/xerces/impl/XMLScanner.java.oden	2011-06-13 10:24:04.000000000 +0000
@@ -1027,6 +1027,14 @@ public abstract class XMLScanner
                     if (XMLChar.isMarkup(c) || c == ']') {
                         fStringBuffer.append((char)fEntityScanner.scanChar());
                     }
+                    else if (XMLChar.isHighSurrogate(c)) {
+                        scanSurrogates(fStringBuffer);
+                    }
+                    else if (isInvalidLiteral(c)) {
+                        reportFatalError("InvalidCharInSystemID",
+                            new Object[] { Integer.toHexString(c) });
+                        fEntityScanner.scanChar();
+                    }
                 } while (fEntityScanner.scanLiteral(quote, ident) != quote);
                 fStringBuffer.append(ident);
                 ident = fStringBuffer;
